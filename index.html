<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U+ 통합신청서 입력 시스템</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; padding: 20px; line-height: 1.6; background-color: #f4f4f4; color: #333; }
        .container { max-width: 850px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #e1007e; border-bottom: 3px solid #e1007e; padding-bottom: 10px; margin-top: 0; }
        h3 { color: #e1007e; font-size: 1.2em; border-left: 5px solid #e1007e; padding-left: 10px; margin: 25px 0 15px 0; }
        h4 { margin: 15px 0 5px 0; color: #555; font-size: 0.95em; background: #f9f9f9; padding: 5px 10px; border-radius: 4px; }
        .section { margin-bottom: 25px; padding: 20px; border: 1px solid #eee; border-radius: 8px; background-color: #fff; }
        .hidden { display: none; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .product-group { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 10px; font-weight: bold; background: #fff0f5; padding: 15px; border-radius: 5px; }
        label { display: block; margin: 8px 0; cursor: pointer; }
        input[type="text"], input[type="email"], select { width: 100%; padding: 10px; margin-top: 5px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
        .address-input { background-color: #fff; border: 1px solid #e1007e !important; cursor: pointer; font-weight: bold; }
        input[type="checkbox"], input[type="radio"] { transform: scale(1.2); margin-right: 8px; vertical-align: middle; }
        button { background: #e1007e; color: white; padding: 18px; border: none; border-radius: 5px; cursor: pointer; font-size: 20px; width: 100%; font-weight: bold; margin-top: 30px; }
    </style>
</head>
<body>

<div class="container">
    <h2>U+ 통합신청서 입력</h2>
    <form id="applyForm">
        
        <div class="section" style="background-color: #fef0f7; border: 1px solid #e1007e;">
            <div class="input-grid">
                <label><strong>유치자:</strong> 
                    <input type="text" name="유치자" placeholder="유치자 성함 입력">
                </label>
                <label><strong>제휴처:</strong> 
                    <input type="text" name="제휴처" placeholder="제휴처 명칭 입력">
                </label>
            </div>
        </div>
        
        <div class="section">
            <h3>1. 가입자 정보</h3>
            <div class="input-grid">
                <label>고객명(법인명): <input type="text" name="고객명" required></label>
                <label>연락처: <input type="text" name="연락처" required placeholder="010-0000-0000"></label>
                <label>사업자등록번호: <input type="text" name="사업자등록번호" placeholder="000-00-00000"></label>
                <label>생년월일/법인등록번호: <input type="text" name="생년월일" placeholder="6자리 또는 법인번호"></label>
            </div>
            <label>주소 (클릭 검색): <input type="text" id="main_address" name="주소_기본" class="address-input" readonly onclick="execDaumPostcode()"></label>
            <label>상세 주소: <input type="text" id="detail_address" name="주소_상세" placeholder="상세주소 입력"></label>
            <input type="hidden" name="주소" id="full_address">

            <h4>청구 및 납부 설정</h4>
            <div class="product-group" style="background: #f9f9f9;">
                <span style="width:100%; margin-bottom:5px;">통합청구신청:</span>
                <div style="display: flex; align-items: center; gap: 10px; width: 100%;">
                    <label style="margin: 0;"><input type="checkbox" name="체크1"> 기존 청구서 통합</label>
                    <input type="text" name="청구서번호" placeholder="청구서 번호 입력" style="width: 200px; padding: 5px; border: 1px solid #e1007e; border-radius: 4px;">
                    <label style="margin: 0; margin-left: 20px;"><input type="checkbox" name="체크2"> 신규 신청</label>
                </div>
            </div>
            
            <div class="product-group" style="background: #f9f9f9;">
                <span style="width:100%; margin-bottom:5px;">요금확인방법:</span>
                <label><input type="checkbox" name="체크3"> 이메일</label>
                <label><input type="checkbox" name="체크4"> 우편</label>
                <input type="text" name="이메일" placeholder="이메일 주소 입력" style="width: 200px; margin-left: 10px;">
            </div>

            <div class="product-group" style="background: #fdf2f8;">
                <span style="width:100%; margin-bottom:5px;">납부방법:</span>
                <label><input type="checkbox" name="체크5"> 자동이체</label>
                <label><input type="checkbox" name="체크6"> 카드결제</label>
                <label><input type="checkbox" name="체크7"> 지로납부</label>
            </div>

            <h4>자동이체/카드 정보</h4>
            <div class="input-grid">
                <label>예금주/카드주: <input type="text" name="예금주"></label>
                <label>은행/카드사: <input type="text" name="은행"></label>
                <label>계좌/카드번호: <input type="text" name="계좌번호"></label>
                <label>카드 유효기간: <input type="text" name="유효기간" placeholder="MM/YY"></label>
            </div>

            <h4>납부일 선택</h4>
            <div class="product-group">
                <label><input type="checkbox" name="체크10"> 15일</label>
                <label><input type="checkbox" name="체크18"> 18일</label>
                <label><input type="checkbox" name="체크20"> 22일</label>
                <label><input type="checkbox" name="체크26"> 26일</label>
            </div>
        </div>

       <div class="section">
            <h3>2. 공통 서비스 정보</h3>
            
            <h4>서비스 약정기간</h4>
            <div class="product-group">
                <label><input type="checkbox" name="체크12"> 3년</label>
                <label><input type="checkbox" name="체크13"> 1년</label>
                <label><input type="checkbox" name="체크14"> 5년</label>
                <label><input type="checkbox" name="무약정"> 무약정</label>
            </div>

            <h4>설치 정보</h4>
            <div style="margin-bottom: 10px;">
                <label style="display: inline-block; font-weight: bold; color: #e1007e;">
                    <input type="checkbox" id="same_as_above" onchange="copyAddress()"> 가입자 정보 주소와 동일
                </label>
            </div>
            <label>설치주소 (클릭 검색): 
                <input type="text" id="install_address" name="설치주소" class="address-input" readonly onclick="execDaumPostcode('install')" placeholder="주소를 입력하거나 위와 동일을 체크하세요">
            </label>
            
            <div class="input-grid">
                <label>담당자 성함: <input type="text" name="담당자" placeholder="설치 장소 담당자"></label>
                <label>휴대폰번호: <input type="text" name="휴대폰" placeholder="010-0000-0000"></label>
            </div>
        </div>
        <button type="button" id="submitBtn" onclick="submitForm()">신청서 생성 및 전송</button>
    </form>
</div>

<script>
    function execDaumPostcode(type) {
        new daum.Postcode({
            oncomplete: function(data) {
                var addr = data.userSelectedType === 'R' ? data.roadAddress : data.jibunAddress;
                if(type === 'install') { document.getElementsByName("설치주소")[0].value = addr; }
                else { document.getElementById("main_address").value = addr; document.getElementById("detail_address").focus(); }
            }
        }).open();
    }

    function toggleSection(sectionId, btnId) {
        const section = document.getElementById(sectionId);
        const checkbox = document.getElementById(btnId);
        section.style.display = checkbox.checked ? 'block' : 'none';
    }

    async function submitForm() {
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwT_e1H9ZhT3sLyn3M8vQ1d5guFbF3B_lfESCmbjdHVEK09jnjnKzOsafUtHrF-2whk/exec";
        const form = document.getElementById('applyForm');
        document.getElementById("full_address").value = document.getElementById("main_address").value + " " + document.getElementById("detail_address").value;

        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.innerText = "전송 중...";

        const data = {};
        const formData = new FormData(form);
        for (let [key, value] of formData.entries()) { data[key] = value; }
        
        form.querySelectorAll('input[type="checkbox"]').forEach(cb => {
            data[cb.name] = cb.checked ? "v" : "";
        });

        // 자동 날짜 및 서명 데이터
        const today = new Date();
        data['년'] = today.getFullYear(); data['월'] = today.getMonth() + 1; data['일'] = today.getDate();
        data['서명'] = data['고객명']; // 고객명을 서명으로 자동 사용
        data['예금주2'] = data['예금주']; // 예금주 중복 태그 처리

        try {
            const queryString = new URLSearchParams(data).toString();
            await fetch(WEB_APP_URL + "?" + queryString, { method: 'POST', mode: 'no-cors' });
            alert("신청서 접수가 완료되었습니다!");
            location.reload();
        } catch (e) {
            alert("오류가 발생했습니다.");
            submitBtn.disabled = false;
        }
    }
</script>
</body>
</html>
