<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>U+ 서비스 신청서</title>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; background-color: #f4f4f4; }
        .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h2 { color: #e1007e; border-bottom: 2px solid #e1007e; padding-bottom: 10px; }
        .section { margin-bottom: 25px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .hidden { display: none; }
        .product-group { display: flex; gap: 20px; margin-bottom: 20px; font-weight: bold; background: #fff0f5; padding: 15px; border-radius: 5px; }
        label { display: block; margin: 8px 0; }
        input[type="text"], input[type="email"], select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
        button { background: #e1007e; color: white; padding: 15px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 18px; width: 100%; }
        button:hover { background: #b10063; }
    </style>
</head>
<body>

<div class="container">
    <h2>U+ 통합신청서 입력</h2>
    <form id="applyForm">
        <div class="section">
            <h3>기본 정보</h3>
            <label>고객명: <input type="text" name="고객명" required></label>
            <label>연락처: <input type="text" name="연락처" required></label>
            <label>주소: <input type="text" name="주소" required></label>
            <label>이메일: <input type="email" name="이메일"></label>
        </div>

        <div class="section">
            <h3>서비스 선택 (먼저 체크하세요)</h3>
            <div class="product-group">
                <label><input type="checkbox" name="체크54" id="btn54" onchange="toggleProduct('officeNet', 'btn54')"> U+ 오피스넷</label>
                <label><input type="checkbox" name="체크55" id="btn55" onchange="toggleProduct('iptv', 'btn55')"> U+ 기업 IPTV</label>
                <label><input type="checkbox" name="체크56" id="btn56" onchange="toggleProduct('phone', 'btn56')"> U+ 인터넷 전화</label>
            </div>
        </div>

        <div id="officeNet" class="section hidden">
            <h3>오피스넷 세부설정</h3>
            <label><input type="checkbox" name="체크15"> 오피스 100M</label>
            <label><input type="checkbox" name="체크16"> 오피스 500M</label>
            <label><input type="checkbox" name="체크17"> 기가오피스넷(1G)</label>
            <label>설치주소: <input type="text" name="설치주소"></label>
        </div>

        <div id="iptv" class="section hidden">
            <h3>IPTV 세부설정</h3>
            <label><input type="checkbox" name="체크12"> 프리미엄</label>
            <label><input type="checkbox" name="체크13"> 기본형</label>
            <label>셋톱박스 대수: <input type="text" name="subcount"></label>
        </div>

        <div id="phone" class="section hidden">
            <h3>인터넷전화 세부설정</h3>
            <label>모델명: <input type="text" name="모델명"></label>
            <label>전화대수: <input type="text" name="전화대수"></label>
            <label><input type="checkbox" name="체크45"> 신규</label>
            <label><input type="checkbox" name="체크46"> 번호이동</label>
        </div>

        <button type="button" onclick="submitForm()">신청서 생성 및 전송</button>
    </form>
</div>

<script>
    // 1. 조건부 노출 로직
    function toggleProduct(sectionId, btnId) {
        const section = document.getElementById(sectionId);
        const checkbox = document.getElementById(btnId);
        
        if (checkbox.checked) {
            section.classList.remove('hidden');
        } else {
            section.classList.add('hidden');
        }
    }

    // 2. 데이터 전송 로직
    async function submitForm() {
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwT_e1H9ZhT3sLyn3M8vQ1d5guFbF3B_lfESCmbjdHVEK09jnjnKzOsafUtHrF-2whk/exec"; // <--- 여기에 복사한 주소를 넣으세요!
        const form = document.getElementById('applyForm');
        const formData = new FormData(form);
        const data = {};

        // 체크박스 처리 (체크되면 'v', 안되면 '')
        form.querySelectorAll('input[type="checkbox"]').forEach(cb => {
            data[cb.name] = cb.checked ? "v" : "";
        });

        // 텍스트 입력값 처리
        form.querySelectorAll('input[type="text"], input[type="email"]').forEach(input => {
            data[input.name] = input.value;
        });

        // 오늘 날짜 자동 삽입
        const today = new Date();
        data['년'] = today.getFullYear();
        data['월'] = today.getMonth() + 1;
        data['일'] = today.getDate();

        try {
            const queryString = new URLSearchParams(data).toString();
            await fetch(WEB_APP_URL + "?" + queryString, { method: 'POST' });
            alert("신청이 완료되었습니다! 잠시 후 구글 드라이브에서 PDF를 확인하세요.");
        } catch (e) {
            alert("전송 중 오류가 발생했습니다.");
        }
    }
</script>

</body>
</html>
