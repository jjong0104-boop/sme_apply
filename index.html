<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U+ 통합신청서 시스템</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; padding: 20px; line-height: 1.6; background-color: #f4f4f4; color: #333; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #e1007e; border-bottom: 3px solid #e1007e; padding-bottom: 10px; margin-top: 0; }
        h3 { color: #e1007e; font-size: 1.2em; border-left: 5px solid #e1007e; padding-left: 10px; margin: 25px 0 15px 0; }
        h4 { margin: 15px 0 10px 0; color: #555; font-size: 1em; background: #fdf2f8; padding: 8px; border-radius: 4px; font-weight: bold; }
        .section { margin-bottom: 25px; padding: 20px; border: 1px solid #eee; border-radius: 8px; background-color: #fff; }
        .hidden { display: none; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .product-group { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 15px; font-weight: bold; background: #fff0f5; padding: 15px; border-radius: 5px; }
        .sub-box { border: 1px solid #eee; padding: 15px; border-radius: 8px; margin-bottom: 15px; background: #fafafa; }
        .payment-box { border: 2px solid #e1007e; padding: 20px; border-radius: 8px; margin-top: 10px; background: #fffafc; }
        label { display: block; margin: 8px 0; cursor: pointer; }
        input[type="text"], input[type="email"], select { width: 100%; padding: 10px; margin-top: 5px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
        .num-input { width: 80px !important; display: inline-block; padding: 5px !important; text-align: center; border: 1px solid #e1007e !important; }
        .address-input { background-color: #fff; border: 1px solid #e1007e !important; cursor: pointer; font-weight: bold; }
        input[type="checkbox"], input[type="radio"] { transform: scale(1.2); margin-right: 8px; vertical-align: middle; }
        button { background: #e1007e; color: white; padding: 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 20px; width: 100%; font-weight: bold; margin-top: 30px; transition: 0.3s; }
        button:hover { background: #b10063; transform: translateY(-2px); }
    </style>
</head>
<body>

<div class="container">
    <h2>U+ 통합신청서 입력</h2>
    <form id="applyForm">
        
        <div class="section" style="background-color: #fef0f7; border: 1px solid #e1007e;">
            <div class="input-grid">
                <label>유치자: <input type="text" name="유치자"></label>
                <label>제휴처: <input type="text" name="제휴처"></label>
            </div>
        </div>

        <div class="section">
            <h3>1. 가입자 정보</h3>
            <div class="input-grid">
                <label>고객명: <input type="text" name="고객명" id="cust_name" required></label>
                <label>연락처: <input type="text" name="연락처" required></label>
                <label>사업자등록번호: <input type="text" name="사업자등록번호"></label>
                <label>생년월일(법인번호): <input type="text" name="생년월일"></label>
            </div>
            <label>주소 (클릭 검색): <input type="text" id="main_address" name="주소_기본" class="address-input" readonly onclick="execDaumPostcode()"></label>
            <label>상세 주소: <input type="text" id="detail_address" name="주소_상세"></label>
            <input type="hidden" name="주소" id="full_address">

            <h4>청구 및 납부 설정</h4>
            <div class="product-group">
                <span>통합청구신청:</span>
                <label><input type="checkbox" name="체크1"> 기존 통합</label>
                <input type="text" name="청구서번호" placeholder="청구서 번호" style="width: 150px; margin: 0 10px;">
                <label><input type="checkbox" name="체크2"> 신규 신청</label>
            </div>
            
            <div class="product-group">
                <span>납부방법 선택:</span>
                <label><input type="radio" name="pay_type" value="bank" onclick="togglePayment('bank')"> 자동이체(계좌)</label>
                <label><input type="radio" name="pay_type" value="card" onclick="togglePayment('card')"> 카드결제</label>
                <label><input type="radio" name="pay_type" value="paper" onclick="togglePayment('none')"> 지로납부</label>
            </div>

            <div id="bank_info" class="payment-box hidden">
                <div class="input-grid">
                    <label>예금주명: <input type="text" name="예금주"></label>
                    <label>은행명: <input type="text" name="은행"></label>
                    <label>계좌번호: <input type="text" name="계좌번호"></label>
                </div>
            </div>

            <div id="card_info" class="payment-box hidden">
                <div class="input-grid">
                    <label>카드주명: <input type="text" name="카드주명"></label>
                    <label>카드사명: <input type="text" name="카드사"></label>
                    <label>카드번호: <input type="text" name="카드번호"></label>
                    <label>유효기간: <input type="text" name="유효기간" placeholder="MM/YY"></label>
                </div>
            </div>

            <div class="product-group">
                <span>납부일:</span>
                <label><input type="checkbox" name="체크10"> 15일</label>
                <label><input type="checkbox" name="체크18"> 18일</label>
                <label><input type="checkbox" name="체크20"> 22일</label>
                <label><input type="checkbox" name="체크26"> 26일</label>
            </div>
        </div>

        <div class="section">
            <h3>2. 서비스 신청사항</h3>
            <div class="product-group">
                <label><input type="checkbox" name="체크54" id="btn54" onchange="toggleSection('officeNet', 'btn54')"> U+ 오피스넷</label>
                <label><input type="checkbox" name="체크55" id="btn55" onchange="toggleSection('iptv', 'btn55')"> U+ 기업 IPTV</label>
                <label><input type="checkbox" name="체크56" id="btn56" onchange="toggleSection('phone', 'btn56')"> U+ 인터넷 전화</label>
            </div>

            <div id="officeNet" class="hidden sub-box">
                <h4>U+ 오피스넷 설정</h4>
                <div class="product-group">요금제: <label><input type="checkbox" name="체크15"> 100M</label><label><input type="checkbox" name="체크16"> 500M</label><label><input type="checkbox" name="체크17"> 1G</label><label><input type="checkbox" name="체크18"> 10G</label></div>
                
                <div class="product-group">
                    IP신청: 
                    <label><input type="checkbox" name="체크19"> 유동 IP ( <input type="text" name="유동IP" class="num-input"> 개 )</label>
                    <label><input type="checkbox" name="체크20"> 고정 IP ( <input type="text" name="고정IP" class="num-input"> 개 )</label>
                </div>

                <div class="product-group">장비: <label><input type="checkbox" name="체크21"> 광모뎀</label><label><input type="checkbox" name="체크22"> L2</label><label><input type="checkbox" name="체크23"> 공유기형</label> | 3년약정: <label><input type="checkbox" name="체크24"> 체크</label></div>
                
                <div class="product-group">
                    통신렉구매: 
                    <label><input type="checkbox" name="체크32"> 소형 ( <input type="text" name="체크32_val" class="num-input" placeholder="번호"> )</label>
                    <label><input type="checkbox" name="체크33"> 표준형 ( <input type="text" name="체크33_val" class="num-input" placeholder="번호"> )</label>
                    <label><input type="checkbox" name="체크34"> 대형 ( <input type="text" name="체크34_val" class="num-input" placeholder="번호"> )</label>
                    <label><input type="checkbox" name="체크35"> DCS전용 ( <input type="text" name="체크35_val" class="num-input" placeholder="번호"> )</label>
                </div>

                <div class="input-grid">
                    <label>번들(Y/N): <select name="yesorno1"><option value="">선택</option><option value="Y">Y</option><option value="N">N</option></select></label>
                    <label>구내공사(Y/N): <select name="yesorno21"><option value="">선택</option><option value="Y">Y</option><option value="N">N</option></select></label>
                </div>
            </div>

            <div id="iptv" class="hidden sub-box">
                <h4>U+ 기업 IPTV 설정 (체크55)</h4>
                <div class="product-group">
                    요금제: <label><input type="checkbox" name="체크40"> 프리미엄</label>
                    <label><input type="checkbox" name="체크41"> 기본</label>
                    <label><input type="checkbox" name="체크42"> 실속</label>
                    <label><input type="checkbox" name="체크43"> 단체</label>
                </div>
                <div class="input-grid">
                    <label>오피스넷 회선번호 (12자리): <input type="text" name="회선번호" maxlength="12" placeholder="숫자만 입력"></label>
                    <label>와이파이 모델명/개수: <input type="text" name="와이파이모델" placeholder="모델명 및 개수 입력"></label>
                </div>
                <div class="product-group">
                    <label><input type="checkbox" name="체크44"> UHD 셋탑 ( <input type="text" name="UHD" class="num-input"> 대 )</label>
                </div>
            </div>

            <div id="phone" class="hidden sub-box">
                <h4>인터넷전화 상세 (체크56)</h4>
                <div class="input-grid">
                    <label>모델명: <input type="text" name="모델명"></label>
                    <label>전화대수: <input type="text" name="전화대수"></label>
                </div>
            </div>
        </div>

        <button type="button" id="submitBtn" onclick="submitForm()">신청서 생성 및 전송</button>
    </form>
</div>

<script>
    function togglePayment(type) {
        document.getElementById('bank_info').style.display = (type === 'bank') ? 'block' : 'none';
        document.getElementById('card_info').style.display = (type === 'card') ? 'block' : 'none';
    }

    function execDaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                document.getElementById("main_address").value = data.userSelectedType === 'R' ? data.roadAddress : data.jibunAddress;
                document.getElementById("detail_address").focus();
            }
        }).open();
    }

    function toggleSection(id, btnId) {
        document.getElementById(id).style.display = document.getElementById(btnId).checked ? 'block' : 'none';
    }

    async function submitForm() {
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwT_e1H9ZhT3sLyn3M8vQ1d5guFbF3B_lfESCmbjdHVEK09jnjnKzOsafUtHrF-2whk/exec";
        const form = document.getElementById('applyForm');
        document.getElementById("full_address").value = document.getElementById("main_address").value + " " + document.getElementById("detail_address").value;
        
        const btn = document.getElementById('submitBtn');
        btn.disabled = true; btn.innerText = "전송 중...";

        const data = {};
        new FormData(form).forEach((val, key) => { data[key] = val; });
        form.querySelectorAll('input[type="checkbox"]').forEach(cb => { data[cb.name] = cb.checked ? "v" : ""; });

        // 라디오 버튼 치환
        const payType = form.querySelector('input[name="pay_type"]:checked')?.value;
        if (payType === 'bank') data['체크5'] = 'v';
        if (payType === 'card') data['체크6'] = 'v';
        if (payType === 'paper') data['체크7'] = 'v';

        const today = new Date();
        data['년'] = today.getFullYear(); data['월'] = today.getMonth() + 1; data['일'] = today.getDate();
        data['서명'] = data['고객명'];

        try {
            await fetch(WEB_APP_URL + "?" + new URLSearchParams(data).toString(), { method: 'POST', mode: 'no-cors' });
            alert("신청이 완료되었습니다!");
            location.reload();
        } catch (e) { alert("오류 발생"); btn.disabled = false; }
    }
</script>
</body>
</html>
