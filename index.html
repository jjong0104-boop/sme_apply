<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U+ 통합신청서 입력 시스템</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; padding: 20px; line-height: 1.6; background-color: #f4f4f4; color: #333; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #e1007e; border-bottom: 3px solid #e1007e; padding-bottom: 10px; margin-top: 0; }
        h3 { color: #e1007e; font-size: 1.2em; border-left: 5px solid #e1007e; padding-left: 10px; margin: 25px 0 15px 0; }
        h4 { margin: 15px 0 10px 0; color: #555; font-size: 1em; background: #fdf2f8; padding: 8px; border-radius: 4px; font-weight: bold; }
        .section { margin-bottom: 25px; padding: 20px; border: 1px solid #eee; border-radius: 8px; background-color: #fff; }
        .hidden { display: none; }
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .product-group { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 15px; font-weight: bold; background: #fff0f5; padding: 15px; border-radius: 5px; }
        .sub-box { border: 1px solid #eee; padding: 15px; border-radius: 8px; margin-bottom: 15px; background: #fafafa; }
        label { display: block; margin: 8px 0; cursor: pointer; }
        input[type="text"], input[type="email"], select { width: 100%; padding: 10px; margin-top: 5px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
        .address-input { background-color: #fff; border: 1px solid #e1007e !important; cursor: pointer; font-weight: bold; }
        input[type="checkbox"] { transform: scale(1.2); margin-right: 8px; vertical-align: middle; }
        .date-display { text-align: right; margin-top: 40px; border-top: 2px solid #333; padding-top: 20px; font-weight: bold; color: #666; }
        button { background: #e1007e; color: white; padding: 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 20px; width: 100%; font-weight: bold; margin-top: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: 0.3s; }
        button:hover { background: #b10063; transform: translateY(-2px); }
    </style>
</head>
<body>

<div class="container">
    <h2>U+ 통합신청서 입력</h2>
    <form id="applyForm">
        
        <div class="section" style="background-color: #fef0f7; border: 1px solid #e1007e;">
            <div class="input-grid">
                <label>유치자: <input type="text" name="유치자" placeholder="유치자 성함"></label>
                <label>제휴처: <input type="text" name="제휴처" placeholder="제휴처 명칭"></label>
            </div>
        </div>

        <div class="section">
            <h3>1. 가입자 기본 정보</h3>
            <div class="input-grid">
                <label>고객명(신청인): <input type="text" name="고객명" id="cust_name" required></label>
                <label>연락처: <input type="text" name="연락처" required></label>
                <label>사업자등록번호: <input type="text" name="사업자등록번호"></label>
                <label>생년월일(법인번호): <input type="text" name="생년월일"></label>
            </div>
            <label>주소 (클릭 검색): <input type="text" id="main_address" name="주소_기본" class="address-input" readonly onclick="execDaumPostcode()"></label>
            <label>상세 주소: <input type="text" id="detail_address" name="주소_상세"></label>
            <input type="hidden" name="주소" id="full_address">

            <h4>청구 및 납부 설정</h4>
            <div class="product-group">
                <span style="width:100%;">통합청구신청:</span>
                <label><input type="checkbox" name="체크1"> 기존 통합</label>
                <input type="text" name="청구서번호" placeholder="청구서 번호" style="width: 150px; margin: 0 10px;">
                <label><input type="checkbox" name="체크2"> 신규 신청</label>
            </div>
            
            <div class="product-group">
                <span style="width:100%;">납부방법:</span>
                <label><input type="checkbox" name="체크5"> 자동이체(계좌)</label>
                <label><input type="checkbox" name="체크6"> 카드결제</label>
                <label><input type="checkbox" name="체크7"> 지로납부</label>
            </div>

            <div class="input-grid sub-box">
                <label>예금주/카드주명: <input type="text" name="예금주"></label>
                <label>은행/카드사명: <input type="text" name="은행"></label>
                <label>계좌/카드번호: <input type="text" name="계좌번호"></label>
                <label>유효기간(카드만): <input type="text" name="유효기간" placeholder="MM/YY"></label>
            </div>

            <div class="product-group">
                <span>납부일:</span>
                <label><input type="checkbox" name="체크10"> 15일</label>
                <label><input type="checkbox" name="체크18"> 18일</label>
                <label><input type="checkbox" name="체크20"> 22일</label>
                <label><input type="checkbox" name="체크26"> 26일</label>
            </div>
        </div>

        <div class="section">
            <h3>2. 공통 서비스 정보</h3>
            <h4>서비스 약정기간</h4>
            <div class="product-group">
                <label><input type="checkbox" name="체크12"> 3년</label>
                <label><input type="checkbox" name="체크13"> 1년</label>
                <label><input type="checkbox" name="체크14"> 5년</label>
            </div>
            <h4>설치 정보</h4>
            <label style="color: #e1007e; font-weight: bold;"><input type="checkbox" id="same_as_above" onchange="copyAddress()"> 가입자 정보 주소와 동일</label>
            <label>설치주소: <input type="text" id="install_address" name="설치주소" class="address-input" readonly onclick="execDaumPostcode('install')"></label>
            <div class="input-grid">
                <label>담당자 성함: <input type="text" name="담당자"></label>
                <label>휴대폰번호: <input type="text" name="휴대폰"></label>
            </div>
        </div>

        <div class="section">
            <h3>3. 서비스 신청사항</h3>
            <div class="product-group">
                <label><input type="checkbox" name="체크54" id="btn54" onchange="toggleSection('officeNet', 'btn54')"> U+ 오피스넷</label>
                <label><input type="checkbox" name="체크55" id="btn55" onchange="toggleSection('iptv', 'btn55')"> U+ 기업 IPTV</label>
                <label><input type="checkbox" name="체크56" id="btn56" onchange="toggleSection('phone', 'btn56')"> U+ 인터넷 전화</label>
            </div>

            <div id="officeNet" class="hidden sub-box">
                <h4>오피스넷 (체크54)</h4>
                <div class="product-group">요금제: <label><input type="checkbox" name="체크15"> 100M</label><label><input type="checkbox" name="체크16"> 500M</label><label><input type="checkbox" name="체크17"> 1G</label><label><input type="checkbox" name="체크18"> 10G</label></div>
                <div class="product-group">IP신청: <label><input type="checkbox" name="체크19"> 유동</label><label><input type="checkbox" name="체크20"> 고정</label></div>
                <div class="product-group">장비: <label><input type="checkbox" name="체크21"> 광모뎀</label><label><input type="checkbox" name="체크22"> L2</label><label><input type="checkbox" name="체크23"> 공유기형</label> | 3년약정: <label><input type="checkbox" name="체크24"> 체크</label></div>
                <div class="product-group">와이파이: <label><input type="checkbox" name="체크27"> 기가</label><label><input type="checkbox" name="체크28"> 프리미엄</label> | 3년약정: <label><input type="checkbox" name="체크29"> 체크</label></div>
                <div class="product-group">통신렉: <label><input type="checkbox" name="체크32"> 소</label><label><input type="checkbox" name="체크33"> 표준</label><label><input type="checkbox" name="체크34"> 대</label><label><input type="checkbox" name="체크35"> DCS</label></div>
                <div class="product-group">렉약정: <label><input type="checkbox" name="체크36"> 3년</label><label><input type="checkbox" name="체크37"> 2년</label><label><input type="checkbox" name="체크38"> 1년</label><label><input type="checkbox" name="체크39"> 무약정</label></div>
                <div class="input-grid"><label>번들(Y/N): <input type="text" name="yesorno1"></label><label>구내공사(Y/N): <input type="text" name="yesorno21"></label></div>
            </div>

            <div id="iptv" class="hidden sub-box">
                <h4>기업 IPTV (체크55)</h4>
                <div class="product-group"><label><input type="checkbox" name="체크40"> 프리미엄</label><label><input type="checkbox" name="체크41"> 기본</label><label><input type="checkbox" name="체크42"> 실속</label><label><input type="checkbox" name="체크43"> 단체</label></div>
                <label><input type="checkbox" name="체크44"> UHD 셋탑</label> <label>수량: <input type="text" name="UHD" style="width:50px;"> 대</label>
            </div>

            <div id="phone" class="hidden sub-box">
                <h4>인터넷전화 (체크56)</h4>
                <div class="input-grid"><label><input type="checkbox" name="체크45"> 신규(<input type="text" name="신규회선" style="width:30px;">)</label><label><input type="checkbox" name="체크46"> 번이(<input type="text" name="번호이동회선" style="width:30px;">)</label></div>
                <label>희망번호: <input type="text" name="희망번호"></label>
                <div class="product-group"><label><input type="checkbox" name="체크47"> 센트릭스</label><label><input type="checkbox" name="체크57"> 고급형</label> | 모델: <input type="text" name="model" style="width:80px;"></div>
                <div class="product-group">장비할부(S): <label><input type="checkbox" name="체크61"> 일시불</label><label><input type="checkbox" name="체크62"> 3년</label></div>
                <div class="input-grid"><label>단말모델명: <input type="text" name="모델명"></label><label>전화대수: <input type="text" name="전화대수"></label></div>
                <div class="product-group">장비할부(D): <label><input type="checkbox" name="체크49"> 일시불</label><label><input type="checkbox" name="체크50"> 3년</label> | 보조: <input type="text" name="subcount" style="width:30px;"></div>
                <label><input type="checkbox" name="체크51"> CPG 1포트</label> <label>포트대수: <input type="text" name="포트대수" style="width:40px;"></label>
                <div class="product-group"><label><input type="checkbox" name="체크52"> 종량</label><label><input type="checkbox" name="체크53"> 정액</label></div>
                <div class="input-grid"><label>정액제명: <input type="text" name="정액제명"></label><label>회선수: <input type="text" name="회선수"></label><label>대상번호: <input type="text" name="대상번호"></label></div>
                <label>부가서비스: <input type="text" name="부가서비스"></label>
            </div>
        </div>

        <div class="date-display" id="dateDisplay"></div>

        <button type="button" id="submitBtn" onclick="submitForm()">신청서 생성 및 전송</button>
    </form>
</div>

<script>
    const today = new Date();
    document.getElementById('dateDisplay').innerText = `${today.getFullYear()}년 ${today.getMonth() + 1}월 ${today.getDate()}일`;

    function execDaumPostcode(type) {
        new daum.Postcode({
            oncomplete: function(data) {
                var addr = data.userSelectedType === 'R' ? data.roadAddress : data.jibunAddress;
                if(type === 'install') document.getElementById("install_address").value = addr;
                else { document.getElementById("main_address").value = addr; document.getElementById("detail_address").focus(); }
            }
        }).open();
    }

    function copyAddress() {
        if (document.getElementById("same_as_above").checked) {
            document.getElementById("install_address").value = document.getElementById("main_address").value + " " + document.getElementById("detail_address").value;
        } else document.getElementById("install_address").value = "";
    }

    function toggleSection(id, btnId) {
        document.getElementById(id).style.display = document.getElementById(btnId).checked ? 'block' : 'none';
    }

    async function submitForm() {
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwT_e1H9ZhT3sLyn3M8vQ1d5guFbF3B_lfESCmbjdHVEK09jnjnKzOsafUtHrF-2whk/exec";
        const form = document.getElementById('applyForm');
        document.getElementById("full_address").value = document.getElementById("main_address").value + " " + document.getElementById("detail_address").value;
        
        const btn = document.getElementById('submitBtn');
        btn.disabled = true; btn.innerText = "전송 중...";

        const data = {};
        new FormData(form).forEach((val, key) => { data[key] = val; });
        form.querySelectorAll('input[type="checkbox"]').forEach(cb => { data[cb.name] = cb.checked ? "v" : ""; });

        // 신청인 및 서명 자동 매핑 (고객명으로 통일)
        data['년'] = today.getFullYear(); data['월'] = today.getMonth() + 1; data['일'] = today.getDate();
        data['신청인'] = data['고객명']; 
        data['서명'] = data['고객명'];
        data['예금주2'] = data['예금주'];

        try {
            await fetch(WEB_APP_URL + "?" + new URLSearchParams(data).toString(), { method: 'POST', mode: 'no-cors' });
            alert("신청서 접수 완료! PDF가 생성됩니다.");
            location.reload();
        } catch (e) { alert("오류 발생"); btn.disabled = false; }
    }
</script>
</body>
</html>
